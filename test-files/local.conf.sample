DISTRO = "poky"
PACKAGE_CLASSES = "package_ipk"

# for meta-beagleboard kernels add:
## kernel-devicetree-overlays kernel-module-musb-dsps

CORE_IMAGE_EXTRA_INSTALL += "\
    kernel-modules \
    libcgroup \
    nano \
    vim \
    ltp \
    rsync \
    bash \
    screen \
    pax-utils \
    pps-tools \
    mtd-utils \
    devmem2 \
    net-snmp \
    net-snmp-server \
    sysfsutils \
    spitools \
    i2c-tools \
    usbutils \
    distro-feed-configs \
    gkrellmd \
    ${BB_BRINGUP} \
    ${TOUCH} \
    ${QT5} \
"

BB_BRINGUP = " \
        iw \
        bonnie++ \
        hdparm \
        iozone3 \
        iperf \
        lmbench \
        rt-tests \
        evtest \
        bc \
        memtester \
"

TOUCH = "\
        tslib-conf \
        tslib-tests \
        tslib-calibrate \
        tslib \
        evtest \
        dbus \
"

QT5 = "\
      qtbase \
      qtbase-tools \
      qtbase-plugins \
      qtbase-fonts \
      qtwebkit-examples \
      qt5-demo-extrafiles \
      cinematicexperience \
      gstreamer \
      cairo pango \
      fontconfig \
      freetype \
      alsa-lib \
      alsa-tools \
      alsa-state \
      alsa-utils \
      alsa-utils-scripts \
"

DEFAULT_TEST_SUITES_remove_beaglebone = "connman"
IMAGE_FEATURES += "splash ssh-server-openssh package-management"

EXTRA_IMAGE_FEATURES = "debug-tweaks ptest-pkgs tools-debug tools-testapps"

MACHINE = "beaglebone"
#BBMASK ?= ".*/meta-ti/recipes-misc/(images|payload)/"

DEFAULTTUNE = "cortexa8hf-neon"
COMPATIBLE_MACHINE_beaglebone = "beaglebone"

# this is needed if not using yocto bsp beaglebone machine config
# see also extra u-boot settings in bbappend
#IMAGE_BOOT_FILES = "u-boot.${UBOOT_SUFFIX} MLO"

SERIAL_CONSOLE = "115200 ttyS0"
IMAGE_FSTYPES = "tar.bz2"

#PREFERRED_PROVIDER_virtual/kernel = "linux-ti-rpmsg"
#PREFERRED_PROVIDER_virtual/kernel = "linux-ti-dev"
#PREFERRED_PROVIDER_virtual/kernel = "linux-bb-kernel"

PREFERRED_PROVIDER_virtual/kernel = "linux-boneblack"
PREFERRED_VERSION_linux-boneblack = "4.6%"

PREFERRED_PROVIDER_virtual/bootloader = "u-boot"
#PREFERRED_VERSION_virtual/bootloader = "2016.03%"

VIRTUAL-RUNTIME_dev_manager = "udev"
VIRTUAL-RUNTIME_login_manager = "busybox"
VIRTUAL-RUNTIME_init_manager = "sysvinit"
VIRTUAL-RUNTIME_initscripts = "initscripts"
VIRTUAL-RUNTIME_keymaps = "keymaps"

# can also try sgx/opengl as provider - libgles-omap3 or libgles-omap3-x11
PREFERRED_PROVIDER_virtual/mesa = "mesa"
PREFERRED_PROVIDER_virtual/libgl = "mesa"
REFERRED_PROVIDER_virtual/egl = "mesa"
#PREFERRED_PROVIDER_virtual/libgles2 = "mesa"

PREFERRED_PROVIDER_jpeg = "libjpeg-turbo"
PREFERRED_PROVIDER_jpeg-native = "libjpeg-turbo-native"

DL_DIR = "/home/user/shared/downloads"
# Where to place shared-state files
SSTATE_DIR = "/home/user/shared/poky/sstate-cache"

INHERIT += "rm_work"
INHERIT += "buildhistory"
INHERIT += "toaster"

# need this for real-time audio (includes RT_GROUP_SCHED)
KERNEL_ENABLE_CGROUPS = "1"

# try out java/fortran support
JAVA = ",java"
JAVA_arm = ",java"
FORTRAN = ",fortran"
FORTRAN_forcevariable = ",fortran"
RUNTIMETARGET_append_pn-gcc-runtime = " libquadmath"

# set color of beaglebone (leave blank or set to 0 for white)
BONE_IS_BLACK = "1"

# possible values are internal or external
CUSTOM_FEED_CONFIG = "internal"

# set internal feed URL
CUSTOM_FEED_URL = "www.local.domain"

LICENSE_FLAGS_WHITELIST = "\
  commercial_gst-fluendo-mp3 \
  commercial_gst-openmax \
  commercial_gst-plugins-ugly \
  commercial \
  commercial_lame \
  commercial_libmad \
  commercial_libomxil \
  commercial_mpeg2dec \
  commercial_qmmp"

DISTRO_FEATURES_append = " opengl pam pulseaudio udev x11"
DISTRO_FEATURES_BACKFILL_CONSIDERED = "systemd wayland"

# Additional image features
# NOTE: if listing mklibs & prelink both, then make sure mklibs is before prelink
# NOTE: mklibs also needs to be explicitly enabled for a given image, see local.conf.extended
# image-prelink disabled for now due to issues with IFUNC symbol relocation
USER_CLASSES ?= "buildstats image-mklibs"

#OE_TERMINAL = "auto"
# By default disable interactive patch resolution (tasks will just fail instead):
PATCHRESOLVE = "noop"

BB_DISKMON_DIRS = "\
    STOPTASKS,${TMPDIR},1G,100K \
    STOPTASKS,${DL_DIR},1G,100K \
    STOPTASKS,${SSTATE_DIR},1G,100K \
    STOPTASKS,/tmp,100M,100K \
    ABORT,${TMPDIR},100M,1K \
    ABORT,${DL_DIR},100M,1K \
    ABORT,${SSTATE_DIR},100M,1K \
    ABORT,/tmp,10M,1K"

#PACKAGECONFIG_append_pn-qemu-native = " sdl"
#PACKAGECONFIG_append_pn-nativesdk-qemu = " sdl"
ASSUME_PROVIDED += "libsdl-native"

# CONF_VERSION is increased each time build/conf/ changes incompatibly and is used to
# track the version of this file when it was generated. This can safely be ignored if
# this doesn't mean anything to you.
CONF_VERSION = "1"
